<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EduLinker — MVP Offline v2</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap');

    :root{
      --c-primary:#0b5bd4;
      --c-primary-600:#0a49af;
      --c-secondary:#11c2c2;
      --c-bg:#e8f1ff;
      --c-gradient-soft:#f8fbff;
      --c-surface:#ffffff;
      --c-text:#0b2140;
      --c-muted:#5a6d90;
      --radius:20px;
      --shadow-soft:0 18px 40px rgba(11,48,94,0.12);
      --shadow-card:0 25px 60px rgba(11,91,212,0.18);
    }

    *{box-sizing:border-box}
    html,body{margin:0;height:100%}
    body{
      font-family:'Outfit',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,sans-serif;
      color:var(--c-text);
      background:
        radial-gradient(circle at 15% 20%,rgba(17,194,194,0.28),transparent 50%),
        radial-gradient(circle at 80% 0%,rgba(11,91,212,0.2),transparent 62%),
        linear-gradient(180deg,var(--c-bg) 0%,#fefeff 55%,var(--c-gradient-soft) 100%);
      min-height:100%;
      line-height:1.6;
    }

    .container{
      max-width:1200px;
      margin:0 auto;
      padding:32px 24px 60px;
      min-height:100%;
    }

    .app-shell{
      background:rgba(255,255,255,0.95);
      border:1px solid rgba(11,91,212,0.08);
      border-radius:var(--radius);
      padding:32px 32px 40px;
      box-shadow:var(--shadow-soft),0 30px 80px rgba(17,194,194,0.08);
      backdrop-filter:blur(12px);
    }

    .row{display:grid;gap:20px}
    .grid-2{grid-template-columns:1fr 1fr}
    .grid-3{grid-template-columns:repeat(3,1fr)}
    .landing-grid{align-items:center}
    @media (max-width:900px){
      .grid-2,.grid-3{grid-template-columns:1fr}
      .header{position:static}
      .app-shell{padding:24px 20px}
      .container{padding:20px 16px 40px}
    }

    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom:24px;
      padding:16px 24px;
      border-radius:16px;
      background:linear-gradient(120deg,rgba(255,255,255,0.95),rgba(255,255,255,0.82));
      border:1px solid rgba(11,91,212,0.08);
      box-shadow:0 25px 80px rgba(10,37,82,0.12);
      backdrop-filter:blur(18px);
      position:sticky;
      top:0;
      z-index:3;
      flex-wrap:wrap;
    }

    .tabs{display:flex;gap:10px;flex-wrap:wrap}
    .tabs .btn{
      background:rgba(11,91,212,0.08);
      border-color:transparent;
      color:var(--c-primary);
      box-shadow:inset 0 0 0 1px rgba(11,91,212,0.08);
    }
    .tabs .btn.secondary{
      background:rgba(255,255,255,0.85);
      color:var(--c-muted);
      border:1px solid rgba(90,109,144,0.25);
      box-shadow:0 8px 18px rgba(9,73,175,0.08);
    }
    .tabs .btn:not(.secondary){
      color:#fff;
      background:linear-gradient(130deg,var(--c-primary),var(--c-secondary));
      box-shadow:0 15px 30px rgba(11,91,212,0.3);
    }

    .card{
      background:linear-gradient(180deg,#ffffff,rgba(248,251,255,0.95));
      border:1px solid rgba(11,91,212,0.08);
      border-radius:var(--radius);
      box-shadow:var(--shadow-card);
      transition:transform .2s ease,box-shadow .2s ease;
    }
    .card:hover{transform:translateY(-2px);box-shadow:0 25px 65px rgba(17,194,194,0.28)}
    .card-h{padding:12px 18px;border-bottom:1px solid rgba(10,73,175,0.08);font-weight:600}
    .card-c{padding:18px}

    .btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:12px 18px;
      border-radius:999px;
      border:0;
      background:linear-gradient(135deg,var(--c-primary),var(--c-secondary));
      color:#fff;
      font-weight:600;
      cursor:pointer;
      transition:transform .2s ease,box-shadow .2s ease,background .2s ease;
      box-shadow:0 18px 35px rgba(11,91,212,0.3);
    }
    .btn:hover{transform:translateY(-1px);background:linear-gradient(135deg,var(--c-primary-600),var(--c-secondary))}
    .btn.secondary{
      background:rgba(255,255,255,0.95);
      color:var(--c-primary);
      border:1px solid rgba(11,91,212,0.2);
      box-shadow:0 12px 24px rgba(9,73,175,0.08);
    }
    .btn.outline{
      background:transparent;
      color:var(--c-primary);
      border:1px solid rgba(11,91,212,0.35);
      box-shadow:none;
    }

    .input, select, textarea{
      width:100%;
      padding:12px 14px;
      border:1px solid rgba(11,91,212,0.12);
      border-radius:14px;
      font-size:14px;
      background:rgba(245,248,255,0.9);
      transition:border-color .2s ease,box-shadow .2s ease;
    }
    .input:focus, select:focus, textarea:focus{
      outline:none;
      border-color:var(--c-primary);
      box-shadow:0 0 0 4px rgba(17,194,194,0.25);
    }

    label{font-size:12px;color:var(--c-muted);font-weight:600;display:block;margin-bottom:6px}
    .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 12px;
      border-radius:999px;
      background:linear-gradient(120deg,rgba(11,91,212,0.18),rgba(17,194,194,0.2));
      color:var(--c-primary-600);
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.08em;
      font-weight:700;
      box-shadow:0 12px 24px rgba(11,91,212,0.15);
    }
    .muted{color:var(--c-muted)}
    .title{font-size:42px;font-weight:800;margin:6px 0}
    .subtitle{color:#475569;font-size:18px;max-width:420px}
    .pill{
      display:inline-block;
      padding:6px 14px;
      border-radius:999px;
      background:rgba(17,194,194,0.18);
      color:var(--c-primary-600);
      font-size:13px;
      margin-right:8px;
      margin-bottom:6px;
      border:1px solid rgba(17,194,194,0.3);
    }

    .hero{
      display:flex;
      flex-direction:column;
      gap:14px;
      align-items:center;
      text-align:center;
    }
    .hero-actions{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      justify-content:center;
    }
    .stats-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
      gap:12px;
      margin-top:6px;
      width:100%;
      justify-items:stretch;
    }
    .teacher-grid{grid-auto-rows:1fr}
    .stat-card{
      padding:18px 20px;
      border-radius:16px;
      border:1px solid rgba(11,91,212,0.08);
      background:linear-gradient(135deg,rgba(11,91,212,0.08),rgba(17,194,194,0.18));
      min-height:120px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      text-align:center;
      gap:4px;
    }
    .stat-card strong{display:block;font-size:24px;color:var(--c-primary)}
    .stat-card span{font-size:12px;color:var(--c-muted)}

    .teacher-card{
      position:relative;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      height:100%;
    }
    .teacher-card:before{
      content:'';
      position:absolute;
      inset:0;
      background:linear-gradient(135deg,rgba(17,194,194,0.12),rgba(11,91,212,0.08));
      opacity:0;
      transition:opacity .2s ease;
      pointer-events:none;
    }
    .teacher-card:hover:before{opacity:1}
    .teacher-card .card-c{
      position:relative;
      z-index:1;
      flex:1;
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    .footer{margin-top:32px;text-align:center;color:var(--c-muted);font-size:13px}
    img.logo-landing{
      width:clamp(140px,22vw,220px);
      max-width:100%;
      height:auto;
      display:block;
      margin:4px 0 8px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="app"></div>
    <div class="footer">&copy; <span id="year"></span> EduLinker &mdash; Prot&oacute;tipo MVP. StartupOne FIAP - 10DTSR.</div>
  </div>

<script>
// ===== Utils DOM =====
function el(tag, props={}, ...children){
  const $el = document.createElement(tag);
  for (const [k,v] of Object.entries(props)){
    if (k === 'className' || k === 'class') $el.className = v;
    else if (k.startsWith('on') && typeof v === 'function') $el.addEventListener(k.slice(2).toLowerCase(), v);
    else if (k === 'disabled') v ? $el.setAttribute('disabled','') : $el.removeAttribute('disabled');
    else if (v != null) $el.setAttribute(k, v);
  }
  for (const c of children.flat()){
    if (c == null) continue;
    $el.appendChild(typeof c === 'string' ? document.createTextNode(c) : c);
  }
  return $el;
}
function clear(node){while(node.firstChild) node.removeChild(node.firstChild);}

// ===== Icons (inline SVG) =====
const I = {
  search: () => svg('<path d="M21 21l-4.35-4.35M10 18a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>'),
  mapPin: () => svg('<path d="M12 22s8-5.33 8-12a8 8 0 1 0-16 0c0 6.67 8 12 8 12Z" stroke="currentColor" stroke-width="2"/><circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>'),
  star: () => svg('<path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27Z" fill="currentColor"/>'),
  shield: () => svg('<path d="M12 3l7 4v6c0 5-3.5 7.5-7 8-3.5-.5-7-3-7-8V7l7-4Z" stroke="currentColor" stroke-width="2"/><path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>'),
  calendar: () => svg('<rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/><path d="M16 2v4M8 2v4M3 10h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>'),
  wallet: () => svg('<rect x="2" y="6" width="20" height="12" rx="2" stroke="currentColor" stroke-width="2"/><path d="M16 10h6v4h-6z" stroke="currentColor" stroke-width="2"/>'),
  cap: () => svg('<path d="M12 3L2 9l10 6 10-6-10-6Zm0 12v6" stroke="currentColor" stroke-width="2"/>'),
  wand: () => svg('<path d="M3 21l14-14" stroke="currentColor" stroke-width="2"/><path d="M14 3l1 3 3 1-3 1-1 3-1-3-3-1 3-1 1-3Z" fill="currentColor"/>'),
};
function svg(inner){const s = document.createElementNS('http://www.w3.org/2000/svg','svg'); s.setAttribute('viewBox','0 0 24 24'); s.setAttribute('width','16'); s.setAttribute('height','16'); s.innerHTML=inner; return s;}

// ===== Data (ATUALIZADO) =====
const MOCK_PROFS = [
  { id:'p1', nome:'Ana Ribeiro', verificado:true, materia:['Inglês','Conversação'], precoHora:85, nota:4.9, cidade:'Curitiba', bairro:'Batel', bio:'Professora certificada CELTA, 8 anos de experiência em aulas particulares e corporativas.', metodologia:'Aulas focadas em conversação, feedback imediato e material sob medida.', disponibilidade:['2025-08-11T18:00','2025-08-12T19:00','2025-08-13T09:00'], reviews:128 },
  { id:'p2', nome:'Carlos Mendes', verificado:true, materia:['Cálculo','Física'], precoHora:95, nota:4.7, cidade:'São Paulo', bairro:'Pinheiros', bio:'Mestre em Engenharia (USP). Aulas de reforço para graduação e vestibular.', metodologia:'Resolução de listas, mapas mentais e simulações de prova.', disponibilidade:['2025-08-11T14:00','2025-08-12T16:00','2025-08-14T10:00'], reviews:204 },
  { id:'p3', nome:'Luiza Tavares', verificado:false, materia:['Piano','Teoria Musical'], precoHora:70, nota:4.6, cidade:'Belo Horizonte', bairro:'Savassi', bio:'Pianista com 10 anos de experiência em iniciação musical.', metodologia:'Aulas lúdicas com foco em repertório do aluno e técnica progressiva.', disponibilidade:['2025-08-12T15:00','2025-08-13T18:00'], reviews:46 },
];

const PLANOS = [
  { id:'essencial', nome:'Essencial', preco:0.00, comissao:12, saque:'15 dias', perks:['Suporte básico','Carteira digital','Liberação 15 dias'], destaque:false },
  { id:'destaque', nome:'Destaque', preco:49.90, comissao:8,  saque:'3 dias', perks:['Menor taxa','Liberação 3 dias','Relatórios de ganhos'], destaque:true },
  { id:'premium',  nome:'Premium',  preco:99.90, comissao:6,  saque:'1 dia', perks:['Integração Google Workspace','Liberação 1 dia','Atendimento prioritário'], destaque:false },
];

// ===== State =====
const state = {
  tab:'landing', selecionado:null, slot:null, okAg:false,
  filtros:{ cidade:'', materia:'', ordem:'relevancia' }
};

function setState(patch){ Object.assign(state, patch); render(); }

// ===== ICS =====
function pad(n){return String(n).padStart(2,'0');}
function toICSDate(date){return `${date.getUTCFullYear()}${pad(date.getUTCMonth()+1)}${pad(date.getUTCDate())}T${pad(date.getUTCHours())}${pad(date.getUTCMinutes())}${pad(date.getUTCSeconds())}Z`;}
function buildICSString({ title, description, start, end, location }){
  const dtStamp = toICSDate(new Date());
  const dtStart = toICSDate(start);
  const dtEnd = toICSDate(end);
  const uid = `${Date.now()}@EduLinker`;
  return [
    'BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//EduLinker//MVP//PT-BR','CALSCALE:GREGORIAN','METHOD:PUBLISH','BEGIN:VEVENT',
    `UID:${uid}`,`DTSTAMP:${dtStamp}`,`DTSTART:${dtStart}`,`DTEND:${dtEnd}`,`SUMMARY:${title}`,
    `DESCRIPTION:${(description||'').replace(/\n/g,'\\n')}`,`LOCATION:${location||'Online/Presencial'}`,'END:VEVENT','END:VCALENDAR'
  ].join('\n');
}
function downloadICS(opts){
  const ics = buildICSString(opts);
  const blob = new Blob([ics], { type:'text/calendar;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = `${opts.title.replace(/\s+/g,'_')}.ics`; a.click();
  URL.revokeObjectURL(url);
}

// ===== UI Helpers =====
function Rating(value){
  const full = Math.floor(value);
  return el('div',{class:'flex items-center',style:'display:flex;align-items:center;gap:4px'},
    ...Array.from({length:5}).map((_,i)=>{const s=I.star(); s.style.color = i<full?'#f59e0b':'#e2e8f0'; return s;}),
    el('span',{class:'muted',style:'font-size:12px;color:#64748b'}, value.toFixed(1))
  );
}
function SectionTitle(iconEl, title, subtitle){
  return el('div',{style:'display:flex;justify-content:space-between;margin-bottom:8px'},
    el('div',{},
      el('h3',{style:'font-size:18px;font-weight:700;display:flex;align-items:center;gap:8px'}, iconEl, ' ', title),
      subtitle? el('p',{class:'muted',style:'font-size:14px'}, subtitle): null
    )
  );
}

// ===== Views =====
function ViewLanding(){
  const highlights = [
    { value:'+180', label:'Professores verificados' },
    { value:'2,4k', label:'Aulas confirmadas' },
    { value:'93', label:'NPS médio' }
  ];

  return el('div',{class:'row grid-2 landing-grid'},
    el('div',{class:'hero'},
      (function(){
        const img = new Image();
        img.src = './EduLinker.png';
        img.alt = 'EduLinker';
        img.className = 'logo-landing';
        img.decoding = 'async';
        return img;
      })(),
      el('p',{class:'subtitle'},'Conecte-se com professores verificados para idiomas, exatas, música e muito mais.'),
      el('div',{class:'hero-actions'},
        el('button',{class:'btn',onClick:()=>setState({tab:'buscar'})}, I.search(), 'Encontrar professor'),
        el('button',{class:'btn secondary',onClick:()=>alert('Fluxo explicativo (mock)')}, svg('<path d="M14 3h7v7M10 14l11-11M21 14v7H3V3h7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>'), 'Como funciona')
      ),
      el('div',{},
        el('span',{class:'pill'},'Intermediação de pagamento'),
        el('span',{class:'pill'},'Agenda com .ics'),
        el('span',{class:'pill'},'Professores verificados')
      ),
      el('div',{class:'stats-grid'},
        highlights.map(stat => el('div',{class:'stat-card'}, el('strong',{},stat.value), el('span',{},stat.label)))
      )
    ),
    el('div',{},
      el('div',{class:'card'},
        el('div',{class:'card-h'}, 'Comece agora'),
        el('div',{class:'card-c row'},
          el('div',{class:'row grid-2'},
            el('div',{}, el('label',{},'Seu nome'), el('input',{class:'input',placeholder:'Ex.: Maria'})),
            el('div',{}, el('label',{},'E-mail'), el('input',{class:'input',placeholder:'voce@email.com'}))
          ),
          el('div',{class:'row grid-2'},
            el('div',{}, el('label',{},'Você é'), (function(){const s=el('select',{class:'input'}); s.append(el('option',{value:'aluno'},'Aluno'), el('option',{value:'prof'},'Professor')); return s;})()),
            el('div',{}, el('label',{},'Senha'), el('input',{class:'input',type:'password',placeholder:'••••••••'}))
          ),
          el('button',{class:'btn'},'Criar conta'),
          el('p',{class:'muted',style:'font-size:12px'},'Ao continuar, você concorda com os Termos & Privacidade.')
        )
      )
    )
  );
}

function ViewBusca(){
  const { cidade, materia, ordem } = state.filtros;
  const results = MOCK_PROFS.filter(p => (!cidade || p.cidade.toLowerCase().includes(cidade.toLowerCase())) && (!materia || p.materia.some(m=>m.toLowerCase().includes(materia.toLowerCase()))))
    .sort((a,b)=> ordem==='preco'? a.precoHora-b.precoHora : ordem==='nota'? b.nota-a.nota : b.reviews-a.reviews);

  return el('div',{class:'row'},
    SectionTitle(I.search(),'Encontre um professor','Filtre por cidade/bairro, matéria, preço e nota'),
    el('div',{class:'card'},
      el('div',{class:'card-c row grid-3'},
        el('div',{}, el('label',{},'Cidade/Bairro'), el('input',{class:'input',value:cidade,oninput:(ev)=>{state.filtros.cidade=ev.target.value; render();},placeholder:'Ex.: Curitiba, Batel'})),
        el('div',{}, el('label',{},'Matéria'), el('input',{class:'input',value:materia,oninput:(ev)=>{state.filtros.materia=ev.target.value; render();},placeholder:'Ex.: Inglês, Cálculo'})),
        el('div',{}, el('label',{},'Ordenar por'), (function(){const s=el('select',{class:'input',value:ordem,onchange:(ev)=>{state.filtros.ordem=ev.target.value; render();}}); s.append(
          el('option',{value:'relevancia'},'Relevância'), el('option',{value:'nota'},'Nota'), el('option',{value:'preco'},'Preço/h')
        ); return s;})()),
        el('div',{}, el('button',{class:'btn outline',style:'width:100%'}, I.mapPin(), 'Usar minha região'))
      )
    ),
    el('div',{class:'row grid-3 teacher-grid'},
      results.map(p => el('div',{class:'card teacher-card'},
        el('div',{class:'card-c'},
          (function(){
            const header = el('div',{style:'display:flex;align-items:center;gap:10px'});
            const avatar = el('div',{style:'height:40px;width:40px;border-radius:999px;background:#c9f2ff;display:grid;place-items:center;font-weight:700'}, p.nome.split(' ')[0][0]);
            const info = el('div',{style:'flex:1;min-width:0'});
            const nameLine = el('div',{style:'display:flex;gap:8px;align-items:center;flex-wrap:wrap'}, el('span',{style:'font-weight:600'}, p.nome));
            if(p.verificado){ nameLine.append(el('span',{class:'badge'}, I.shield(), 'Verificado')); }
            info.append(nameLine, el('div',{class:'muted',style:'font-size:12px;display:flex;align-items:center;gap:6px'}, I.mapPin(), ` ${p.bairro}, ${p.cidade}`));
            header.append(avatar, info);
            return header;
          })(),
          el('div',{style:'display:flex;flex-wrap:wrap;gap:6px'}, ...p.materia.map(m=> el('span',{class:'pill'},m))),
          el('p',{class:'muted',style:'font-size:14px'}, p.bio),
          el('div',{style:'display:flex;flex-direction:column;gap:10px;margin-top:auto;padding-top:12px;border-top:1px solid rgba(11,91,212,0.12)'},
            el('div',{style:'display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap'},
              el('div',{style:'display:flex;align-items:center;gap:6px'}, Rating(p.nota)),
              el('span',{style:'font-weight:600;color:var(--c-text)'}, `R$ ${p.precoHora}/hora`)
            ),
            el('button',{class:'btn',onclick:()=>{ setState({tab:'perfil', selecionado:p}); }}, 'Ver perfil')
          )
        )
      ))
    )
  );
}

function ViewPerfil(){
  const p = state.selecionado; if(!p) return el('p',{class:'muted'},'Selecione um professor.');
  return el('div',{class:'row grid-2'},
    el('div',{},
      el('div',{class:'card'},
        el('div',{class:'card-c row'},
          (function(){
            const top = el('div',{style:'display:flex;gap:8px;align-items:center'});
            const avatar = el('div',{style:'height:40px;width:40px;border-radius:999px;background:#c9f2ff;display:grid;place-items:center;font-weight:700'}, p.nome.split(' ')[0][0]);
            const info = el('div',{});
            const name = el('div',{style:'display:flex;gap:8px;align-items:center'}, el('span',{style:'font-size:18px;font-weight:700'}, p.nome));
            if(p.verificado){ name.append(el('span',{class:'badge'}, I.shield(), 'Verificado')); }
            info.append(name, el('div',{class:'muted',style:'display:flex;align-items:center;gap:6px'}, I.mapPin(), ` ${p.bairro}, ${p.cidade}`));
            top.append(avatar, info);
            return top;
          })(),
          el('div',{style:'display:flex;justify-content:space-between;align-items:center'}, Rating(p.nota), el('div',{},`${p.reviews} avaliações`)),
          el('div',{}, ...p.materia.map(m=> el('span',{class:'pill'},m))),
          el('div',{}, el('div',{style:'font-weight:600'},'Metodologia'), el('p',{class:'muted'}, p.metodologia))
        )
      ),
      el('div',{class:'card',style:'margin-top:12px'},
        el('div',{class:'card-h'}, el('span',{style:'display:inline-flex;gap:8px;align-items:center'}, I.calendar(), 'Agenda')),
        el('div',{class:'card-c row',style:'grid-template-columns:repeat(3,1fr)'},
          p.disponibilidade.map(iso=>{
            const dt = new Date(iso); const label = dt.toLocaleString('pt-BR',{dateStyle:'short', timeStyle:'short'});
            return el('button',{class:'btn outline',onclick:()=>{ setState({tab:'agendar', slot:{prof:p, iso}}); }}, label);
          })
        )
      )
    ),
    el('div',{},
      el('div',{class:'card'},
        el('div',{class:'card-c row'},
          el('div',{style:'font-size:24px;font-weight:800'}, `R$ ${p.precoHora}`, el('span',{class:'muted',style:'font-size:12px;font-weight:400'},'/hora')),
          el('p',{class:'muted'},'Pagamento intermediado pelo ', el('b',{},'EduLinker'), '. O valor fica em custódia e é liberado ao professor conforme o plano.'),
          el('button',{class:'btn',onclick:()=>{ setState({tab:'agendar', slot:{prof:p, iso:p.disponibilidade[0]}}); }}, 'Agendar primeiro horário')
        )
      ),
      el('div',{class:'card',style:'margin-top:12px'},
        el('div',{class:'card-h'}, el('span',{style:'display:inline-flex;gap:8px;align-items:center'}, I.shield(), 'Segurança')),
        el('div',{class:'card-c muted'}, 'Professores passam por verificação de identidade e comprovação de experiência/certificação.')
      )
    )
  );
}

function ViewAgendar(){
  const slot = state.slot; if(!slot) return null; const dt = new Date(slot.iso);
  let local = 'Online (Meet)'; let obs = '';
  function confirmar(){
    const inicio = dt; const fim = new Date(dt.getTime()+60*60*1000);
    downloadICS({ title:`Aula com ${slot.prof.nome}`, description:`Disciplina: ${slot.prof.materia.join(', ')}\nObservações: ${obs}`, start:inicio, end:fim, location:local });
    setState({ okAg:true });
  }
  return el('div',{class:'row'},
    el('div',{class:'card'},
      el('div',{class:'card-h'}, el('span',{style:'display:inline-flex;gap:8px;align-items:center'}, I.calendar(), 'Confirmar agendamento')),
      el('div',{class:'card-c row'},
        el('div',{class:'row grid-3'},
          el('div',{}, el('label',{},'Professor'), el('input',{class:'input',value:slot.prof.nome,disabled:true})),
          el('div',{}, el('label',{},'Data e horário'), el('input',{class:'input',value:dt.toLocaleString('pt-BR',{dateStyle:'short', timeStyle:'short'}),disabled:true})),
          el('div',{}, el('label',{},'Local'), (function(){const s=el('select',{class:'input',onchange:(ev)=>{local=ev.target.value;}}); s.append(el('option',{},'Online (Meet)'), el('option',{},'Presencial - combinar')); return s;})())
        ),
        el('div',{}, el('label',{},'Observações'), (function(){const t=el('textarea',{class:'input',placeholder:'Ex.: foco em conversação, trazer material X',oninput:(ev)=>{obs=ev.target.value;}}); return t;})()),
        el('div',{style:'display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:12px;background:#ecfeff'},
          el('div',{class:'muted',style:'font-size:14px'}, el('b',{},'Intermediação de pagamento: '), 'o aluno paga agora e o valor é liberado conforme o plano (Essencial 15 dias • Destaque 3 dias • Premium 1 dia).'),
          el('button',{class:'btn',onclick:confirmar}, I.calendar(), 'Salvar .ics')
        )
      )
    ),
    state.okAg ? el('div',{class:'card',style:'border:1px solid #16a34a;background:#f0fdf4'}, el('div',{class:'card-c',style:'display:flex;justify-content:space-between;align-items:center'}, el('div',{},'Agendamento salvo no seu calendário (.ics). Você também receberá um lembrete por e-mail.'), el('button',{class:'btn secondary',onclick:()=>setState({tab:'aluno'})},'Ir para Área do Aluno'))) : null
  );
}

function ViewAluno(){
  return el('div',{class:'row'},
    SectionTitle(I.cap(),'Área do Aluno','Acompanhe suas aulas e recibos'),
    el('div',{class:'row grid-3'},
      el('div',{class:'card',style:'grid-column:span 2'}, el('div',{class:'card-h'},'Próximas aulas'), el('div',{class:'card-c row'},
        el('div',{style:'padding:12px;border:1px solid #e2e8f0;border-radius:12px;display:flex;justify-content:space-between;align-items:center'},
          el('div',{}, el('div',{style:'font-weight:600'},'Inglês com Ana Ribeiro'), el('div',{class:'muted'}, '12/08/2025 19:00 — Online')),
          el('button',{class:'btn outline'},'Ver detalhes')
        )
      )),
      el('div',{class:'card'}, el('div',{class:'card-h'},'Recibos'), el('div',{class:'card-c muted'},'Ao finalizar a aula, o recibo fica disponível aqui.'))
    )
  );
}

function ViewPainel(){
  return el('div',{class:'row'},
    SectionTitle(I.wallet(),'Painel do Professor','Gerencie agenda, alunos, carteira e assinatura'),
    el('div',{class:'row grid-3'},
      el('div',{class:'card'}, el('div',{class:'card-h'},'Carteira'), el('div',{class:'card-c'}, el('div',{style:'font-size:24px;font-weight:800'},'R$ 1.240,00'), el('div',{class:'muted'},'A liberar: R$ 620,00 (3 dias)'), el('button',{class:'btn'},'Solicitar saque (PIX)'))),
      el('div',{class:'card'}, el('div',{class:'card-h'},'Agenda de hoje'), el('div',{class:'card-c'}, el('div',{style:'padding:12px;border:1px solid #e2e8f0;border-radius:12px;margin-bottom:8px'},'19:00 — Ana (Inglês) — Online (Meet)'), el('div',{style:'padding:12px;border:1px solid #e2e8f0;border-radius:12px'},'21:00 — João (Conversação) — Online (Meet)'))),
      el('div',{class:'card'}, el('div',{class:'card-h'},'Assinatura'), el('div',{class:'card-c muted'},'Plano atual: ', el('b',{},'Destaque'),' • Taxa 8% • Saque 3 dias'))
    ),
    el('div',{class:'card'},
      el('div',{class:'card-h'},'Diário de bordo'),
      el('div',{class:'card-c row grid-3'},
        el('div',{}, el('label',{},'Aluno'), (function(){const s=el('select',{class:'input'}); s.append(el('option',{value:'ana'},'Ana'), el('option',{value:'joao'},'João')); return s;})(), el('label',{},'Resumo da aula'), el('textarea',{class:'input',placeholder:'Conteúdo dado, lição de casa, observações...'}), el('button',{class:'btn',style:'margin-top:6px'},'Salvar registro')),
        el('div',{style:'grid-column:span 2'},
          diarioItem('Ana','05/08/2025','Revisamos tempos verbais; melhorar listening com podcasts.'),
          diarioItem('João','03/08/2025','Conversação sobre viagens; próxima aula: phrasal verbs.')
        )
      )
    )
  );
}
function diarioItem(nome,data,nota){
  return el('div',{style:'padding:12px;border:1px solid #e2e8f0;border-radius:12px;margin-bottom:8px'},
    el('div',{style:'display:flex;justify-content:space-between;align-items:center'}, el('div',{style:'font-weight:600'},nome), el('div',{class:'muted',style:'font-size:12px;display:inline-flex;gap:6px;align-items:center'}, data)),
    el('div',{class:'muted'}, nota)
  );
}

function ViewPlanos(){
  return el('div',{class:'row'},
    SectionTitle(I.shield(),'Planos para Professores','Escolha o plano ideal para seus objetivos'),
    el('div',{class:'row grid-3'},
      PLANOS.map(pl => el('div',{class:'card',style: pl.destaque?'border-color:#0891b2;box-shadow:0 8px 24px rgba(8,145,178,.15)':''},
        el('div',{class:'card-c row'},
          el('div',{style:'display:flex;justify-content:space-between;align-items:center'}, el('span',{style:'font-weight:700'}, pl.nome), pl.destaque? el('span',{class:'badge',style:'background:#0891b2;color:white'},'Recomendado'): null),
          pl.id==='essencial'
            ? el('div',{style:'display:flex;align-items:center;gap:10px'},
                el('span',{style:'font-size:32px;font-weight:800;color:#059669'},'Grátis'),
                el('span',{class:'badge',style:'background:#059669;color:#fff'},'Sem mensalidade')
              )
            : el('div',{style:'font-size:28px;font-weight:800'}, `R$ ${pl.preco.toLocaleString('pt-BR',{minimumFractionDigits:2})}`, el('span',{class:'muted',style:'font-size:12px;font-weight:400'},'/mês')),
          el('div',{}, 'Comissão por aula: ', el('b',{}, `${pl.comissao}%`)),
          el('div',{}, 'Prazo de liberação: ', el('b',{}, pl.saque)),
          el('div',{}, ...pl.perks.map(k=> el('span',{class:'pill'},k))),
          el('button',{class:'btn'},`Assinar ${pl.nome}`)
        )
      ))
    ),
    el('div',{class:'card'}, el('div',{class:'card-h'},'Como funcionam taxas e intermediação'), el('div',{class:'card-c muted'},
      el('p',{},'O pagamento da aula é feito pelo aluno dentro do EduLinker. O valor fica em custódia e é liberado para a carteira do professor conforme o plano. As taxas da plataforma são aplicadas no momento do repasse.'),
      (function(){
        const list = el('ul',{});
        PLANOS.forEach(pl => {
          const extra = pl.id==='premium' ? ' • inclui Google Workspace (Meet/Drive)' : '';
          list.append(el('li',{}, el('b',{}, pl.nome), `: ${pl.comissao}% • ${pl.saque}${extra}`));
        });
        return list;
      })()
    ))
  );
}

function ViewVerificacao(){
  return el('div',{class:'row'},
    SectionTitle(I.shield(),'Verificação de Professores','Garante qualidade e segurança para alunos'),
    el('div',{class:'card'}, el('div',{class:'card-c row grid-3'},
      el('div',{}, el('label',{},'Documento de identidade (RG/CPF)'), el('input',{class:'input',type:'file'})),
      el('div',{}, el('label',{},'Comprovante de experiência'), el('input',{class:'input',type:'file'}), el('p',{class:'muted',style:'font-size:12px'},'Diploma, certificado ou portfólio (PDF/links).')),
      el('div',{}, el('label',{},'Comprovante bancário'), el('input',{class:'input',type:'file'})),
      el('div',{style:'grid-column:span 3'}, el('button',{class:'btn'},'Enviar para análise'), el('p',{class:'muted',style:'font-size:12px;margin-top:6px'},'Status atual: ', el('b',{},'Em análise')))
    ))
  );
}

// ===== App Frame =====
function App(){
  const header = el('div',{class:'header'},
    el('div',{style:'display:flex;align-items:center;gap:8px'}, el('div',{style:'height:36px;width:36px;border-radius:12px;background:var(--c-primary);color:#fff;display:grid;place-items:center;font-weight:800'},'EL'), el('div',{}, el('div',{style:'font-weight:700'},'EduLinker'), el('div',{class:'muted',style:'margin-top:-4px;font-size:12px'},'Conectando professores e alunos de forma inteligente'))),
    el('div',{class:'tabs'},
      tabBtn('landing','Início'), tabBtn('buscar',elFrag(I.search(),'Buscar')), tabBtn('aluno',elFrag(I.cap(),'Aluno')), tabBtn('painel',elFrag(I.wallet(),'Professor')), tabBtn('planos',elFrag(I.shield(),'Planos')), tabBtn('verificacao',elFrag(I.wand(),'Verificação'))
    )
  );

  let content;
  switch(state.tab){
    case 'landing': content = ViewLanding(); break;
    case 'buscar': content = ViewBusca(); break;
    case 'perfil': content = ViewPerfil(); break;
    case 'agendar': content = ViewAgendar(); break;
    case 'aluno': content = ViewAluno(); break;
    case 'painel': content = ViewPainel(); break;
    case 'planos': content = ViewPlanos(); break;
    case 'verificacao': content = ViewVerificacao(); break;
    default: content = el('p',{},'');
  }

  return el('div',{class:'app-shell'}, header, el('div',{class:'row',style:'gap:24px'}, content));
}

function elFrag(){ const f = document.createDocumentFragment(); for (const arg of arguments){ f.append(typeof arg==='string'? document.createTextNode(arg): arg); } return f; }
function tabBtn(tab,label){ return el('button',{type:'button','aria-pressed':state.tab===tab?'true':'false',class:'btn '+(state.tab===tab?'':'secondary'), onclick:()=>setState({tab})}, label); }

function render(){ const root = document.getElementById('app'); clear(root); root.append(App()); }

// ===== Init =====
render(); document.getElementById('year').textContent = new Date().getFullYear();

// ===== Smoke tests (console) =====
(function runTests(){
  try{
    // Teste 1: toICSDate
    const dt = new Date(Date.UTC(2025,0,2,3,4,5));
    console.assert(toICSDate(dt) === '20250102T030405Z', 'toICSDate falhou');

    // Teste 2: filtro por cidade
    const curitiba = MOCK_PROFS.filter(p => p.cidade === 'Curitiba');
    console.assert(curitiba.length === 1 && curitiba[0].nome.includes('Ana'), 'Filtro cidade falhou');

    // Teste 3: ordenação por preço (asc)
    const byPrice = [...MOCK_PROFS].sort((a,b)=> a.precoHora - b.precoHora);
    console.assert(byPrice[0].precoHora <= byPrice[1].precoHora, 'Ordenação preço falhou');

    // Teste 4: busca matéria case-insensitive
    const temIngles = MOCK_PROFS.some(p => p.materia.some(m => m.toLowerCase().includes('ingl')));
    console.assert(temIngles, 'Busca por matéria falhou');

    // Teste 5: buildICSString campos essenciais
    const ics = buildICSString({ title:'Teste', description:'Ok', start:new Date('2025-01-01T00:00:00Z'), end:new Date('2025-01-01T01:00:00Z'), location:'Online' });
    console.assert(ics.includes('BEGIN:VEVENT') && ics.includes('SUMMARY:Teste'), 'buildICSString falhou');

    // Teste 6: planos atualizados (nomes e comissões)
    const nomes = PLANOS.map(p=>p.nome).join(',');
    console.assert(nomes.includes('Essencial') && nomes.includes('Destaque') && nomes.includes('Premium'), 'Planos: nomes incorretos');
    const mapa = Object.fromEntries(PLANOS.map(p=>[p.nome,p.comissao]));
    console.assert(mapa['Essencial']===12 && mapa['Destaque']===8 && mapa['Premium']===6, 'Planos: comissões incorretas');

    console.log('%cSmoke tests OK','color:green;font-weight:700');
  }catch(e){ console.error('Smoke tests falharam:', e); }
})();
</script>
</body>
</html>

